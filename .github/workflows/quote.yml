name: âœ¨ Auto Update Daily Quote

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-quote:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Generate daily quote
        run: |
          quotes=(
            "\"The only limit to our realization of tomorrow is our doubts of today.\" â€“ Franklin D. Roosevelt"
            "\"In the middle of difficulty lies opportunity.\" â€“ Albert Einstein"
            "\"Be yourself; everyone else is already taken.\" â€“ Oscar Wilde"
            "\"Every scar is proof that you survived.\" â€“ Unknown"
            "\"Focus on progress, not perfection.\" â€“ Unknown"
            "\"Quiet minds create loud impacts.\" â€“ Unknown"
            "\"The darkest nights produce the brightest stars.\" â€“ Unknown"
            "\"You donâ€™t need to be loud to be strong.\" â€“ Unknown"
          )
          random_quote=${quotes[$RANDOM % ${#quotes[@]}]}
          echo "> $random_quote" > quote.txt

      - name: Update README with quote
        run: |
          # Pastikan file README.md ada
          if [ ! -f README.md ]; then
            echo "README.md not found!"
            exit 1
          fi

          # Ganti isi antara tag <!--START_QUOTE--> dan <!--END_QUOTE-->
          awk -v q="$(cat quote.txt)" '
            /<!--START_QUOTE-->/ {print; getline; print q; next}
            /<!--END_QUOTE-->/ {print; next}
            {print}
          ' README.md > temp && mv temp README.md

      - name: Commit & push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "ðŸª¶ update daily quote"
          git push
